import{H as Qt,T as Zt,M as te}from"./components.ce8e43dd.js";import{a0 as xt,a1 as ft,M as yt,a2 as Tt,a3 as ee,a as H,I as A,C,l as j,v as X,o as p,b as m,f as r,t as c,D as nt,z as k,i as b,p as D,x as F,y as V,u as pt,$ as U,F as wt,P as oe,s as Wt,e as S,w as kt,T as ne,r as K}from"./entry.1822162c.js";import{g as mt}from"./numberUtils.c516b59a.js";import{W as L}from"./WaitingToast.7f89be11.js";import{u as z}from"./user.02811d8a.js";import{u as St}from"./site.3bb70c39.js";import"./composables.ed935133.js";var Bt={},at={},$={},g={},Lt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.add=e.toBig=e.split=e.fromBig=void 0;const t=BigInt(2**32-1),o=BigInt(32);function i(u,h=!1){return h?{h:Number(u&t),l:Number(u>>o&t)}:{h:Number(u>>o&t)|0,l:Number(u&t)|0}}e.fromBig=i;function s(u,h=!1){let d=new Uint32Array(u.length),x=new Uint32Array(u.length);for(let W=0;W<u.length;W++){const{h:ht,l:Jt}=i(u[W],h);[d[W],x[W]]=[ht,Jt]}return[d,x]}e.split=s;const n=(u,h)=>BigInt(u>>>0)<<o|BigInt(h>>>0);e.toBig=n;const a=(u,h,d)=>u>>>d,l=(u,h,d)=>u<<32-d|h>>>d,w=(u,h,d)=>u>>>d|h<<32-d,T=(u,h,d)=>u<<32-d|h>>>d,v=(u,h,d)=>u<<64-d|h>>>d-32,I=(u,h,d)=>u>>>d-32|h<<64-d,f=(u,h)=>h,y=(u,h)=>u,O=(u,h,d)=>u<<d|h>>>32-d,jt=(u,h,d)=>h<<d|u>>>32-d,Ot=(u,h,d)=>h<<d-32|u>>>64-d,qt=(u,h,d)=>u<<d-32|h>>>64-d;function bt(u,h,d,x){const W=(h>>>0)+(x>>>0);return{h:u+d+(W/2**32|0)|0,l:W|0}}e.add=bt;const Ft=(u,h,d)=>(u>>>0)+(h>>>0)+(d>>>0),Vt=(u,h,d,x)=>h+d+x+(u/2**32|0)|0,Yt=(u,h,d,x)=>(u>>>0)+(h>>>0)+(d>>>0)+(x>>>0),Xt=(u,h,d,x,W)=>h+d+x+W+(u/2**32|0)|0,zt=(u,h,d,x,W)=>(u>>>0)+(h>>>0)+(d>>>0)+(x>>>0)+(W>>>0),Gt=(u,h,d,x,W,ht)=>h+d+x+W+ht+(u/2**32|0)|0,Kt={fromBig:i,split:s,toBig:e.toBig,shrSH:a,shrSL:l,rotrSH:w,rotrSL:T,rotrBH:v,rotrBL:I,rotr32H:f,rotr32L:y,rotlSH:O,rotlSL:jt,rotlBH:Ot,rotlBL:qt,add:bt,add3L:Ft,add3H:Vt,add4L:Yt,add4H:Xt,add5H:Gt,add5L:zt};e.default=Kt})(Lt);Object.defineProperty(g,"__esModule",{value:!0});g.shake256=g.shake128=g.keccak_512=g.keccak_384=g.keccak_256=g.keccak_224=g.sha3_512=g.sha3_384=g.sha3_256=g.sha3_224=g.Keccak=g.keccakP=void 0;const q=xt,Q=Lt,J=ft,[Dt,$t,Mt]=[[],[],[]],se=BigInt(0),G=BigInt(1),ie=BigInt(2),ae=BigInt(7),re=BigInt(256),le=BigInt(113);for(let e=0,t=G,o=1,i=0;e<24;e++){[o,i]=[i,(2*o+3*i)%5],Dt.push(2*(5*i+o)),$t.push((e+1)*(e+2)/2%64);let s=se;for(let n=0;n<7;n++)t=(t<<G^(t>>ae)*le)%re,t&ie&&(s^=G<<(G<<BigInt(n))-G);Mt.push(s)}const[ce,ue]=Q.default.split(Mt,!0),_t=(e,t,o)=>o>32?Q.default.rotlBH(e,t,o):Q.default.rotlSH(e,t,o),vt=(e,t,o)=>o>32?Q.default.rotlBL(e,t,o):Q.default.rotlSL(e,t,o);function Et(e,t=24){const o=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let a=0;a<10;a++)o[a]=e[a]^e[a+10]^e[a+20]^e[a+30]^e[a+40];for(let a=0;a<10;a+=2){const l=(a+8)%10,w=(a+2)%10,T=o[w],v=o[w+1],I=_t(T,v,1)^o[l],f=vt(T,v,1)^o[l+1];for(let y=0;y<50;y+=10)e[a+y]^=I,e[a+y+1]^=f}let s=e[2],n=e[3];for(let a=0;a<24;a++){const l=$t[a],w=_t(s,n,l),T=vt(s,n,l),v=Dt[a];s=e[v],n=e[v+1],e[v]=w,e[v+1]=T}for(let a=0;a<50;a+=10){for(let l=0;l<10;l++)o[l]=e[a+l];for(let l=0;l<10;l++)e[a+l]^=~o[(l+2)%10]&o[(l+4)%10]}e[0]^=ce[i],e[1]^=ue[i]}o.fill(0)}g.keccakP=Et;class et extends J.Hash{constructor(t,o,i,s=!1,n=24){if(super(),this.blockLen=t,this.suffix=o,this.outputLen=i,this.enableXOF=s,this.rounds=n,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,q.default.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,J.u32)(this.state)}keccak(){Et(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){q.default.exists(this);const{blockLen:o,state:i}=this;t=(0,J.toBytes)(t);const s=t.length;for(let n=0;n<s;){const a=Math.min(o-this.pos,s-n);for(let l=0;l<a;l++)i[this.pos++]^=t[n++];this.pos===o&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:o,pos:i,blockLen:s}=this;t[i]^=o,(o&128)!==0&&i===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){q.default.exists(this,!1),q.default.bytes(t),this.finish();const o=this.state,{blockLen:i}=this;for(let s=0,n=t.length;s<n;){this.posOut>=i&&this.keccak();const a=Math.min(i-this.posOut,n-s);t.set(o.subarray(this.posOut,this.posOut+a),s),this.posOut+=a,s+=a}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return q.default.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(q.default.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:o,suffix:i,outputLen:s,rounds:n,enableXOF:a}=this;return t||(t=new et(o,i,s,a,n)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=n,t.suffix=i,t.outputLen=s,t.enableXOF=a,t.destroyed=this.destroyed,t}}g.Keccak=et;const P=(e,t,o)=>(0,J.wrapConstructor)(()=>new et(t,e,o));g.sha3_224=P(6,144,224/8);g.sha3_256=P(6,136,256/8);g.sha3_384=P(6,104,384/8);g.sha3_512=P(6,72,512/8);g.keccak_224=P(1,144,224/8);g.keccak_256=P(1,136,256/8);g.keccak_384=P(1,104,384/8);g.keccak_512=P(1,72,512/8);const Pt=(e,t,o)=>(0,J.wrapConstructorWithOpts)((i={})=>new et(t,e,i.dkLen===void 0?o:i.dkLen,!0));g.shake128=Pt(31,168,128/8);g.shake256=Pt(31,136,256/8);var Y={exports:{}};(function(e,t){var o=yt&&yt.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(t,"__esModule",{value:!0}),t.crypto=t.wrapHash=t.equalsBytes=t.hexToBytes=t.bytesToUtf8=t.utf8ToBytes=t.createView=t.concatBytes=t.toHex=t.bytesToHex=t.assertBytes=t.assertBool=void 0;const i=o(xt),s=ft,n=i.default.bool;t.assertBool=n;const a=i.default.bytes;t.assertBytes=a;var l=ft;Object.defineProperty(t,"bytesToHex",{enumerable:!0,get:function(){return l.bytesToHex}}),Object.defineProperty(t,"toHex",{enumerable:!0,get:function(){return l.bytesToHex}}),Object.defineProperty(t,"concatBytes",{enumerable:!0,get:function(){return l.concatBytes}}),Object.defineProperty(t,"createView",{enumerable:!0,get:function(){return l.createView}}),Object.defineProperty(t,"utf8ToBytes",{enumerable:!0,get:function(){return l.utf8ToBytes}});function w(f){if(!(f instanceof Uint8Array))throw new TypeError(`bytesToUtf8 expected Uint8Array, got ${typeof f}`);return new TextDecoder().decode(f)}t.bytesToUtf8=w;function T(f){const y=f.startsWith("0x")?f.substring(2):f;return(0,s.hexToBytes)(y)}t.hexToBytes=T;function v(f,y){if(f.length!==y.length)return!1;for(let O=0;O<f.length;O++)if(f[O]!==y[O])return!1;return!0}t.equalsBytes=v;function I(f){return y=>(i.default.bytes(y),f(y))}t.wrapHash=I,t.crypto=(()=>{const f=typeof self=="object"&&"crypto"in self?self.crypto:void 0,y=typeof Tt=="function"&&Tt.bind(e);return{node:y&&!f?y("crypto"):void 0,web:f}})()})(Y,Y.exports);Object.defineProperty($,"__esModule",{value:!0});$.keccak512=$.keccak384=$.keccak256=$.keccak224=void 0;const Z=g,rt=Y.exports;$.keccak224=(0,rt.wrapHash)(Z.keccak_224);$.keccak256=(()=>{const e=(0,rt.wrapHash)(Z.keccak_256);return e.create=Z.keccak_256.create,e})();$.keccak384=(0,rt.wrapHash)(Z.keccak_384);$.keccak512=(0,rt.wrapHash)(Z.keccak_512);var R={};Object.defineProperty(R,"__esModule",{value:!0});R.hex=R.compareBytes=void 0;const de=Y.exports;function he(e,t){const o=Math.min(e.length,t.length);for(let i=0;i<o;i++)if(e[i]!==t[i])return e[i]-t[i];return e.length-t.length}R.compareBytes=he;function pe(e){return"0x"+(0,de.bytesToHex)(e)}R.hex=pe;var _={},ot={};Object.defineProperty(ot,"__esModule",{value:!0});ot.throwError=void 0;function me(e){throw new Error(e)}ot.throwError=me;Object.defineProperty(_,"__esModule",{value:!0});_.renderMerkleTree=_.isValidMerkleTree=_.processMultiProof=_.getMultiProof=_.processProof=_.getProof=_.makeMerkleTree=void 0;const fe=$,gt=Y.exports,ke=R,lt=ot,ct=(e,t)=>(0,fe.keccak256)((0,gt.concatBytes)(...[e,t].sort(ke.compareBytes))),ut=e=>2*e+1,st=e=>2*e+2,It=e=>e>0?Math.floor((e-1)/2):(0,lt.throwError)("Root has no parent"),Nt=e=>e>0?e-(-1)**(e%2):(0,lt.throwError)("Root has no siblings"),Ut=(e,t)=>t>=0&&t<e.length,we=(e,t)=>Ut(e,ut(t)),ge=(e,t)=>Ut(e,t)&&!we(e,t),Rt=e=>e instanceof Uint8Array&&e.length===32,Ht=(e,t)=>void(ge(e,t)||(0,lt.throwError)("Index is not a leaf")),tt=e=>void(Rt(e)||(0,lt.throwError)("Merkle tree nodes must be Uint8Array of length 32"));function be(e){if(e.forEach(tt),e.length===0)throw new Error("Expected non-zero number of leaves");const t=new Array(2*e.length-1);for(const[o,i]of e.entries())t[t.length-1-o]=i;for(let o=t.length-1-e.length;o>=0;o--)t[o]=ct(t[ut(o)],t[st(o)]);return t}_.makeMerkleTree=be;function ye(e,t){Ht(e,t);const o=[];for(;t>0;)o.push(e[Nt(t)]),t=It(t);return o}_.getProof=ye;function Te(e,t){return tt(e),t.forEach(tt),t.reduce(ct,e)}_.processProof=Te;function _e(e,t){if(t.forEach(n=>Ht(e,n)),t.sort((n,a)=>a-n),t.slice(1).some((n,a)=>n===t[a]))throw new Error("Cannot prove duplicated index");const o=t.concat(),i=[],s=[];for(;o.length>0&&o[0]>0;){const n=o.shift(),a=Nt(n),l=It(n);a===o[0]?(s.push(!0),o.shift()):(s.push(!1),i.push(e[a])),o.push(l)}return t.length===0&&i.push(e[0]),{leaves:t.map(n=>e[n]),proof:i,proofFlags:s}}_.getMultiProof=_e;function ve(e){if(e.leaves.forEach(tt),e.proof.forEach(tt),e.proof.length<e.proofFlags.filter(i=>!i).length)throw new Error("Invalid multiproof format");if(e.leaves.length+e.proof.length!==e.proofFlags.length+1)throw new Error("Provided leaves and multiproof are not compatible");const t=e.leaves.concat(),o=e.proof.concat();for(const i of e.proofFlags){const s=t.shift(),n=i?t.shift():o.shift();if(s===void 0||n===void 0)throw new Error("Broken invariant");t.push(ct(s,n))}if(t.length+o.length!==1)throw new Error("Broken invariant");return t.pop()??o.shift()}_.processMultiProof=ve;function Ae(e){for(const[t,o]of e.entries()){if(!Rt(o))return!1;const i=ut(t),s=st(t);if(s>=e.length){if(i<e.length)return!1}else if(!(0,gt.equalsBytes)(o,ct(e[i],e[s])))return!1}return e.length>0}_.isValidMerkleTree=Ae;function Ce(e){if(e.length===0)throw new Error("Expected non-zero number of nodes");const t=[[0,[]]],o=[];for(;t.length>0;){const[i,s]=t.pop();o.push(s.slice(0,-1).map(n=>["   ","\u2502  "][n]).join("")+s.slice(-1).map(n=>["\u2514\u2500 ","\u251C\u2500 "][n]).join("")+i+") "+(0,gt.bytesToHex)(e[i])),st(i)<e.length&&(t.push([st(i),s.concat(0)]),t.push([ut(i),s.concat(1)]))}return o.join(`
`)}_.renderMerkleTree=Ce;var dt={};Object.defineProperty(dt,"__esModule",{value:!0});dt.checkBounds=void 0;function xe(e,t){if(t<0||t>=e.length)throw new Error("Index out of bounds")}dt.checkBounds=xe;Object.defineProperty(at,"__esModule",{value:!0});at.StandardMerkleTree=void 0;const At=$,B=Y.exports,We=ee,E=R,M=_,Ct=dt,Se=ot;function N(e,t){return(0,At.keccak256)((0,At.keccak256)((0,B.hexToBytes)(We.defaultAbiCoder.encode(t,e))))}class it{constructor(t,o,i){this.tree=t,this.values=o,this.leafEncoding=i,this.hashLookup=Object.fromEntries(o.map(({value:s},n)=>[(0,E.hex)(N(s,i)),n]))}static of(t,o){const i=t.map((a,l)=>({value:a,valueIndex:l,hash:N(a,o)})).sort((a,l)=>(0,E.compareBytes)(a.hash,l.hash)),s=(0,M.makeMerkleTree)(i.map(a=>a.hash)),n=t.map(a=>({value:a,treeIndex:0}));for(const[a,{valueIndex:l}]of i.entries())n[l].treeIndex=s.length-a-1;return new it(s,n,o)}static load(t){if(t.format!=="standard-v1")throw new Error(`Unknown format '${t.format}'`);return new it(t.tree.map(B.hexToBytes),t.values,t.leafEncoding)}static verify(t,o,i,s){const n=(0,M.processProof)(N(i,o),s.map(B.hexToBytes));return(0,B.equalsBytes)(n,(0,B.hexToBytes)(t))}static verifyMultiProof(t,o,i){const s=i.leaves.map(l=>N(l,o)),n=i.proof.map(B.hexToBytes),a=(0,M.processMultiProof)({leaves:s,proof:n,proofFlags:i.proofFlags});return(0,B.equalsBytes)(a,(0,B.hexToBytes)(t))}dump(){return{format:"standard-v1",tree:this.tree.map(E.hex),values:this.values,leafEncoding:this.leafEncoding}}render(){return(0,M.renderMerkleTree)(this.tree)}get root(){return(0,E.hex)(this.tree[0])}*entries(){for(const[t,{value:o}]of this.values.entries())yield[t,o]}validate(){for(let t=0;t<this.values.length;t++)this.validateValue(t);if(!(0,M.isValidMerkleTree)(this.tree))throw new Error("Merkle tree is invalid")}leafHash(t){return(0,E.hex)(N(t,this.leafEncoding))}leafLookup(t){return this.hashLookup[this.leafHash(t)]??(0,Se.throwError)("Leaf is not in tree")}getProof(t){const o=typeof t=="number"?t:this.leafLookup(t);this.validateValue(o);const{treeIndex:i}=this.values[o],s=(0,M.getProof)(this.tree,i);if(!this._verify(this.tree[i],s))throw new Error("Unable to prove value");return s.map(E.hex)}getMultiProof(t){const o=t.map(n=>typeof n=="number"?n:this.leafLookup(n));for(const n of o)this.validateValue(n);const i=o.map(n=>this.values[n].treeIndex),s=(0,M.getMultiProof)(this.tree,i);if(!this._verifyMultiProof(s))throw new Error("Unable to prove values");return{leaves:s.leaves.map(n=>this.values[this.hashLookup[(0,E.hex)(n)]].value),proof:s.proof.map(E.hex),proofFlags:s.proofFlags}}verify(t,o){return this._verify(this.getLeafHash(t),o.map(B.hexToBytes))}_verify(t,o){const i=(0,M.processProof)(t,o);return(0,B.equalsBytes)(i,this.tree[0])}verifyMultiProof(t){return this._verifyMultiProof({leaves:t.leaves.map(o=>this.getLeafHash(o)),proof:t.proof.map(B.hexToBytes),proofFlags:t.proofFlags})}_verifyMultiProof(t){const o=(0,M.processMultiProof)(t);return(0,B.equalsBytes)(o,this.tree[0])}validateValue(t){(0,Ct.checkBounds)(this.values,t);const{value:o,treeIndex:i}=this.values[t];(0,Ct.checkBounds)(this.tree,i);const s=N(o,this.leafEncoding);if(!(0,B.equalsBytes)(s,this.tree[i]))throw new Error("Merkle tree does not contain the expected value");return s}getLeafHash(t){return typeof t=="number"?this.validateValue(t):N(t,this.leafEncoding)}}at.StandardMerkleTree=it;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StandardMerkleTree=void 0;var t=at;Object.defineProperty(e,"StandardMerkleTree",{enumerable:!0,get:function(){return t.StandardMerkleTree}})})(Bt);const Be={name:"GenericNftDrop",props:["claimersData","description","imageClass","merkleClaimerAddress","nftImage","title"],data(){return{isUserEligible:!1,userArrayPosition:-1,waiting:!1}},mounted(){this.isUserEligible||this.checkEligibility()},methods:{checkEligibility(){const e=this.claimersData.claimers.findIndex(t=>t[0].toLowerCase()===this.address.toLowerCase());e>-1?(this.isUserEligible=!0,this.userArrayPosition=e):(this.isUserEligible=!1,this.userArrayPosition=-1)},async claim(){this.waiting=!0;const t=Bt.StandardMerkleTree.of(this.claimersData.claimers,["address","uint256"]).getProof(this.userArrayPosition),o=new A(["function claim(address to_, bytes32[] memory proof_) external"]),i=new C(this.merkleClaimerAddress,o,this.signer);try{const s=await i.claim(this.address,t),n=this.toast({component:L,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+s.hash,"_blank").focus()}),a=await s.wait();a.status===1?(this.toast.dismiss(n),this.toast("You have successfully claimed the NFT!",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+s.hash,"_blank").focus()}),this.waiting=!1):(this.toast.dismiss(n),this.waiting=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+s.hash,"_blank").focus()}),console.log(a))}catch(s){console.error(s);try{let n=s.message.split("reason=")[1];n=n.split(", method=")[0],n=n.replace(/"/g,""),n=n.replace("execution reverted:","Error:"),n=n.replace("MerkleClaimerERC721: ",""),console.log(n),this.toast(n,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waiting=!1}}},setup(){const{address:e,chainId:t,signer:o}=j(),i=X();return{address:e,chainId:t,signer:o,toast:i}},watch:{address(e,t){e&&this.checkEligibility()}}},Le=r("hr",null,null,-1),De={class:"text-center mt-5"},$e={class:"d-flex justify-content-center mt-4 mb-4"},Me=["src"],Ee={key:0,class:"text-center"},Pe={key:1},Ie={class:"text-center"},Ne={class:"d-flex justify-content-center mt-4 mb-4"},Ue=["disabled"],Re={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function He(e,t,o,i,s,n){return p(),m("div",null,[Le,r("h4",De,c(o.title),1),r("div",$e,[r("img",{src:o.nftImage,class:nt(["img-thumbnail",o.imageClass]),style:{"max-width":"200px"},alt:"NFT image"},null,10,Me)]),s.isUserEligible?k("",!0):(p(),m("p",Ee," Not eligible... ")),s.isUserEligible?(p(),m("div",Pe,[r("p",Ie,c(o.description),1),r("div",Ne,[r("button",{disabled:s.waiting,onClick:t[0]||(t[0]=(...a)=>n.claim&&n.claim(...a)),class:"btn btn-outline-primary"},[s.waiting?(p(),m("span",Re)):k("",!0),b(" Claim NFT ")],8,Ue)])])):k("",!0)])}const je=H(Be,[["render",He]]),Oe=[["0x6771F33Cfd8C6FC0A1766331f715f5d2E1d4E0e2",1],["0xb29050965A5AC70ab487aa47546cdCBc97dAE45D",1]],qe={claimers:Oe},Fe={name:"StakingClaim",props:["loadingStakingData","claimAmountWei","claimRewardsTotalWei","futureRewardsWei","lastClaimPeriod","minDepositWei","periodLength"],emits:["clearClaimAmount","updateLastClaimPeriod"],data(){return{claimers:[],waiting:!1}},components:{GenericNftDrop:je,WaitingToast:L},created(){this.claimers=qe},computed:{claimAmount(){return this.claimAmountWei===null||this.claimAmountWei===void 0||this.claimAmountWei===""||this.claimAmountWei==0?0:D(String(this.claimAmountWei))},claimRewardsTotal(){return this.claimRewardsTotalWei===null||this.claimRewardsTotalWei===void 0||this.claimRewardsTotalWei===""||this.claimRewardsTotalWei==0?0:D(String(this.claimRewardsTotalWei))},futureRewards(){return this.futureRewardsWei===null||this.futureRewardsWei===void 0||this.futureRewardsWei===""||this.futureRewardsWei==0?0:D(String(this.futureRewardsWei))},lastPeriodDateTime(){if(this.lastClaimPeriod===null||this.lastClaimPeriod===void 0||this.lastClaimPeriod===""||this.lastClaimPeriod==0)return null;const e=new Date(this.lastClaimPeriod*1e3),t=new Intl.DateTimeFormat("en",{month:"short"}).format(e);return e.getDate()+" "+t+" "+e.getFullYear()+" "+e.getHours()+":"+e.getMinutes().toString().padStart(2,"0")},lastPeriodUpdateNeeded(){return this.lastClaimPeriod===null||this.lastClaimPeriod===void 0||this.lastClaimPeriod===""||this.lastClaimPeriod==0?!1:Math.floor(Date.now()/1e3)-(Number(this.lastClaimPeriod)+Number(this.periodLength))>0},minDeposit(){return this.minDepositWei===null||this.minDepositWei===void 0||this.minDepositWei===""||this.minDepositWei==0?0:D(String(this.minDepositWei))},periodLengthHumanReadable(){if(this.periodLength===null||this.periodLength===void 0||this.periodLength===""||this.periodLength==0)return null;const e=Number(this.periodLength),t=Math.floor(e/60),o=Math.floor(t/60),i=Math.floor(o/24);return i>0?`${i} days`:o>0?`${o} hours`:t>0?`${t} minutes`:`${e} seconds`},stakeTokenBalance(){return D(this.userStore.getStakeTokenBalanceWei)}},methods:{async claim(){this.waiting=!0;const e=new A(["function claimRewards() external returns (uint256)"]),t=new C(this.$config.stakingContractAddress,e,this.signer);try{const o=await t.claimRewards(),i=this.toast({component:L,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),s=await o.wait();s.status===1?(this.$emit("clearClaimAmount"),this.$emit("updateLastClaimPeriod"),this.toast.dismiss(i),this.toast("You have successfully claimed rewards!",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),this.waiting=!1):(this.toast.dismiss(i),this.waiting=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),console.log(s))}catch(o){console.error(o),this.toast(o.message,{type:"error"}),this.waiting=!1}}},setup(){const{address:e,signer:t}=j(),o=X(),i=z();return{address:e,signer:t,toast:o,userStore:i}}},Ve={class:"text-center"},Ye={class:"input-group mt-5"},Xe={class:"btn btn-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:""},ze={class:"d-flex justify-content-center mt-4 mb-4"},Ge=["disabled"],Ke={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},Je={key:1},Qe={key:2},Ze=r("hr",null,null,-1),to=r("h4",{class:"text-center"},"Stats",-1),eo=r("i",{class:"bi bi-info-circle-fill","data-bs-container":"body","data-bs-toggle":"popover","data-bs-placement":"top","data-bs-content":"Claimable now. Note that this is a total number for all stakers together."},null,-1),oo=r("i",{class:"bi bi-info-circle-fill","data-bs-container":"body","data-bs-toggle":"popover","data-bs-placement":"top","data-bs-content":"Accrued rewards so far for all stakers together. Not claimable yet. Will be claimable in the next period."},null,-1),no=r("p",null,[r("small",null," Important: Claim your rewards once per week, otherwise they will be forfeited. ")],-1);function so(e,t,o,i,s,n){return p(),m("div",null,[r("p",Ve," Claim "+c(e.$config.tokenSymbol)+" rewards for the previous period. Make sure to visit this page once per week to claim your rewards! ",1),r("div",Ye,[r("button",Xe,c(e.$config.tokenSymbol),1),F(r("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>n.claimAmount=a),type:"text",class:"form-control",disabled:""},null,512),[[V,n.claimAmount]])]),r("div",ze,[r("button",{disabled:s.waiting,class:"btn btn-outline-primary",type:"button",onClick:t[1]||(t[1]=(...a)=>n.claim&&n.claim(...a))},[o.loadingStakingData||s.waiting?(p(),m("span",Ke)):k("",!0),n.lastPeriodUpdateNeeded?k("",!0):(p(),m("span",Je,"Claim")),n.lastPeriodUpdateNeeded?(p(),m("span",Qe,"Update Claim Period")):k("",!0)],8,Ge)]),Ze,to,r("ul",null,[r("li",null,"Your stake: "+c(pt(mt)(n.stakeTokenBalance))+" "+c(e.$config.lpTokenSymbol)+" ("+c(e.$config.stakeTokenSymbol)+" tokens)",1),r("li",null,[b(" Previous period rewards (total): "+c(pt(mt)(n.claimRewardsTotal))+" "+c(e.$config.tokenSymbol)+" ",1),eo]),r("li",null,[b(" Current period rewards (so far): "+c(pt(mt)(n.futureRewards))+" "+c(e.$config.tokenSymbol)+" ",1),oo]),r("li",null,"Period length: "+c(n.periodLengthHumanReadable),1),r("li",null,"Current period start date: "+c(n.lastPeriodDateTime),1)]),no])}const io=H(Fe,[["render",so]]),ao={name:"AddLiquidity",data(){return{allowanceWei:0,debounce:null,depositAmount:0,ethFieldDisabled:!0,nativeCoinAmount:0,nativeCoinAmountWei:null,timeout:800,waitingApproval:!1,waitingDeposit:!1}},components:{WaitingToast:L},mounted(){this.address&&this.fetchAllowance()},computed:{allowanceTooLow(){return Number(this.allowanceWei)<Number(this.depositAmountWei)},chatBalanceTooLow(){return Number(this.userStore.getChatTokenBalanceWei)<Number(this.depositAmountWei)},chatTokenBalance(){return D(this.userStore.getChatTokenBalanceWei)},depositAmountWei(){return!this.depositAmount||Number(this.depositAmount)===0?0:U(String(this.depositAmount))},nativeBalance(){if(this.balance){const e=Number(D(this.balance));return e>0?e.toFixed(2):e.toFixed(6)}return 0},nativeBalanceTooLow(){return this.balance?Number(this.nativeCoinAmountWei)>Number(this.balance):!1}},methods:{async approveToken(){this.waitingApproval=!0;const e=new A(["function approve(address spender, uint256 amount) public returns (bool)"]),t=new C(this.$config.chatTokenAddress,e,this.signer);try{const o=await t.approve(this.$config.swapRouterAddress,this.depositAmountWei),i=this.toast({component:L,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),s=await o.wait();s.status===1?(this.allowanceWei=this.depositAmountWei,this.toast.dismiss(i),this.toast("You have successfully approved tokens. Now proceed with getting LP tokens!",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),this.waitingApproval=!1,this.deposit()):(this.toast.dismiss(i),this.waitingApproval=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),console.log(s))}catch(o){console.error(o),this.waitingApproval=!1}},async deposit(){this.waitingDeposit=!0;const e=new A(["function addLiquidityETH(address token, uint amountTokenDesired, uint amountTokenMin, uint amountETHMin, address to, uint deadline) external payable returns (uint amountToken, uint amountETH, uint liquidity)"]),t=new C(this.$config.swapRouterAddress,e,this.signer),o=Math.floor(Date.now()/1e3)+60*this.siteStore.getSwapDeadline,i=U(String(this.nativeCoinAmount)),s=Math.floor(Number(this.siteStore.getSlippage)*100),n=i.sub(i.div(1e4).mul(s)),a=this.depositAmountWei.sub(this.depositAmountWei.div(1e4).mul(s));try{const l=await t.addLiquidityETH(this.$config.chatTokenAddress,this.depositAmountWei,a,n,this.address,o,{value:i}),w=this.toast({component:L,props:{text:`Adding liquidity to the ${this.$config.chatTokenSymbol}-${this.$config.tokenSymbol} pool...`}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+l.hash,"_blank").focus()}),T=await l.wait();if(T.status===1){this.toast.dismiss(w),this.toast(`You have successfully provided liquidity and received ${this.$config.lpTokenSymbol}!`,{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+l.hash,"_blank").focus()}),this.allowanceWei.sub(this.depositAmountWei);let v=U(this.chatTokenBalance);this.userStore.setChatTokenBalanceWei(v.sub(this.depositAmountWei)),this.fetchLpTokenBalance()}else this.toast.dismiss(w),this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+l.hash,"_blank").focus()}),console.log(T)}catch(l){console.error(l)}finally{this.waitingDeposit=!1}},async fetchAllowance(){const e=new A(["function allowance(address owner, address spender) public view returns (uint256)"]),t=new C(this.$config.chatTokenAddress,e,this.signer);this.allowanceWei=await t.allowance(this.address,this.$config.swapRouterAddress)},async fetchLpTokenBalance(){const e=new A(["function balanceOf(address account) external view returns (uint256)"]),t=new C(this.$config.lpTokenAddress,e,this.signer);this.userStore.setLpTokenBalanceWei(await t.balanceOf(this.address))},async fetchNativeCoinAmount(){const e=new A(["function calculateETHForLiquidity(address addressToken, uint256 amountToken) external view returns (uint256)"]),t=new C(this.$config.swapRouterAddress,e,this.signer);this.nativeCoinAmountWei=await t.calculateETHForLiquidity(this.$config.chatTokenAddress,U(String(this.depositAmount))),this.nativeCoinAmount=D(this.nativeCoinAmountWei),Number(this.nativeCoinAmountWei)===0&&(this.ethFieldDisabled=!1)},fetchNativeCoinAmountWithTimeout(){this.debounce&&clearTimeout(this.debounce);const e=this;this.debounce=setTimeout(()=>{e.fetchNativeCoinAmount()},e.timeout)},setMaxInputTokenAmount(){this.depositAmount=this.chatTokenBalance,this.fetchNativeCoinAmount()}},setup(){const{address:e,balance:t,signer:o}=j(),i=X(),s=z(),n=St();return{address:e,balance:t,signer:o,siteStore:n,toast:i,userStore:s}},watch:{address(e,t){e&&this.fetchAllowance()}}},ro={class:"text-center"},lo={class:"input-group mt-5"},co={class:"btn btn-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:""},uo=["disabled"],ho=r("small",null,"MAX",-1),po=[ho],mo={class:"text-muted"},fo={class:"input-group mt-5"},ko={class:"btn btn-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:""},wo=["disabled"],go={class:"text-muted"},bo={class:"d-flex justify-content-center mt-4 mb-4"},yo=["disabled"],To={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},_o=["disabled"],vo={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Ao={key:2,disabled:"",class:"btn btn-outline-primary",type:"button"},Co={key:0},xo={key:1},Wo={class:"text-center"},So={key:0,class:"text-center"};function Bo(e,t,o,i,s,n){return p(),m(wt,null,[r("p",ro," No "+c(e.$config.lpTokenSymbol)+"? Add liquidity to the "+c(e.$config.chatTokenSymbol)+"-"+c(e.$config.tokenSymbol)+" pool below to get some. ",1),r("div",lo,[r("button",co,c(e.$config.chatTokenSymbol),1),F(r("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.depositAmount=a),type:"text",class:"form-control",placeholder:"0.00",disabled:s.waitingApproval||s.waitingDeposit,onKeyup:t[1]||(t[1]=(...a)=>n.fetchNativeCoinAmountWithTimeout&&n.fetchNativeCoinAmountWithTimeout(...a))},null,40,uo),[[V,s.depositAmount]]),r("button",{onClick:t[2]||(t[2]=(...a)=>n.setMaxInputTokenAmount&&n.setMaxInputTokenAmount(...a)),class:"btn btn-outline-secondary",type:"button",id:"button-addon2"},po)]),r("small",mo,[r("em",null,[b(" Balance: "),r("span",{class:"cursor-pointer hover-color",onClick:t[3]||(t[3]=(...a)=>n.setMaxInputTokenAmount&&n.setMaxInputTokenAmount(...a))},c(n.chatTokenBalance)+" "+c(e.$config.chatTokenSymbol),1)])]),r("div",fo,[r("button",ko,c(e.$config.tokenSymbol),1),F(r("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>s.nativeCoinAmount=a),type:"text",class:"form-control",disabled:s.ethFieldDisabled},null,8,wo),[[V,s.nativeCoinAmount]])]),r("small",go,[r("em",null,[b(" Balance: "),r("span",null,c(n.nativeBalance)+" "+c(e.$config.tokenSymbol),1)])]),r("div",bo,[n.allowanceTooLow&&!n.nativeBalanceTooLow?(p(),m("button",{key:0,disabled:s.waitingApproval,class:"btn btn-outline-primary",type:"button",onClick:t[5]||(t[5]=(...a)=>n.approveToken&&n.approveToken(...a))},[s.waitingApproval?(p(),m("span",To)):k("",!0),b(" Approve "+c(e.$config.chatTokenSymbol)+" token ",1)],8,yo)):k("",!0),!n.allowanceTooLow&&!n.nativeBalanceTooLow?(p(),m("button",{key:1,disabled:s.waitingDeposit,class:"btn btn-outline-primary",type:"button",onClick:t[6]||(t[6]=(...a)=>n.deposit&&n.deposit(...a))},[s.waitingDeposit?(p(),m("span",vo)):k("",!0),b(" Get "+c(e.$config.lpTokenSymbol),1)],8,_o)):k("",!0),n.nativeBalanceTooLow||n.chatBalanceTooLow?(p(),m("button",Ao,[n.nativeBalanceTooLow&&!n.chatBalanceTooLow?(p(),m("span",Co,c(e.$config.tokenSymbol),1)):k("",!0),n.chatBalanceTooLow?(p(),m("span",xo,c(e.$config.chatTokenSymbol),1)):k("",!0),b(" balance too low ")])):k("",!0)]),r("p",Wo,[n.allowanceTooLow?(p(),m("small",So,[r("em",null," You will need to do 2 transactions: Approve "+c(e.$config.chatTokenSymbol)+" token and then Get "+c(e.$config.lpTokenSymbol)+". ",1)])):k("",!0)])],64)}const Lo=H(ao,[["render",Bo]]),Do={name:"StakingDeposit",props:["loadingStakingData","minDepositWei","maxDepositWei","lpTokenAllowanceWei","lpTokenDecimals"],emits:["clearClaimAmount","subtractBalance","updateAllowance"],data(){return{allowanceWei:0,depositAmount:0,waitingApproval:!1,waitingDeposit:!1}},components:{AddLiquidity:Lo},mounted(){this.allowanceWei=this.lpTokenAllowanceWei},computed:{allowanceTooLow(){return Number(this.allowanceWei)<Number(this.depositAmountWei)},depositAmountWei(){return!this.depositAmount||Number(this.depositAmount)===0?0:oe(String(this.depositAmount),this.lpTokenDecimals)},depositTooLow(){return!this.depositAmount||Number(this.depositAmount)===0?!0:Number(this.depositAmountWei)<Number(this.minDepositWei)},lpTokenBalance(){return Wt(this.userStore.getLpTokenBalanceWei,this.lpTokenDecimals)},minDeposit(){return this.minDepositWei===null||this.minDepositWei===void 0||this.minDepositWei===""||this.minDepositWei==0?0:D(String(this.minDepositWei))}},methods:{async approveToken(){this.waitingApproval=!0;const e=new A(["function approve(address spender, uint256 amount) public returns (bool)"]),t=new C(this.$config.lpTokenAddress,e,this.signer);try{const o=await t.approve(this.$config.stakingContractAddress,this.depositAmountWei),i=this.toast({component:L,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),s=await o.wait();s.status===1?(this.$emit("updateAllowance",this.depositAmountWei),this.toast.dismiss(i),this.toast("You have successfully approved tokens. Now proceed with staking!",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),this.waitingApproval=!1,this.deposit()):(this.toast.dismiss(i),this.waitingApproval=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),console.log(s))}catch(o){console.error(o),this.waitingApproval=!1}},async deposit(){this.waitingDeposit=!0;const e=new A(["function deposit(uint256 _assets) external returns (uint256)"]),t=new C(this.$config.stakingContractAddress,e,this.signer);try{const o=await t.deposit(this.depositAmountWei),i=this.toast({component:L,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),s=await o.wait();s.status===1?(this.$emit("updateAllowance",0),this.$emit("subtractBalance",this.depositAmountWei),this.$emit("clearClaimAmount"),this.toast.dismiss(i),this.toast("You have successfully staked tokens!",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),this.waitingDeposit=!1):(this.toast.dismiss(i),this.waitingDeposit=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),console.log(s))}catch(o){console.error(o),this.toast(o.message,{type:"error"}),this.waitingDeposit=!1}},setMaxInputTokenAmount(){this.depositAmount=this.lpTokenBalance}},setup(){const{signer:e}=j(),t=X(),o=z();return{signer:e,toast:t,userStore:o}},watch:{lpTokenAllowanceWei(){this.allowanceWei=this.lpTokenAllowanceWei}}},$o={class:"text-center"},Mo={class:"input-group mt-5"},Eo={class:"btn btn-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:""},Po=["disabled"],Io=r("small",null,"MAX",-1),No=[Io],Uo={class:"text-muted"},Ro={class:"d-flex justify-content-center mt-4 mb-4"},Ho=["disabled"],jo={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Oo=["disabled"],qo={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Fo={class:"text-center"},Vo={key:0,class:"text-center"},Yo=r("em",null," You will need to do 2 transactions: Approve token and then Stake. ",-1),Xo=[Yo],zo=r("hr",{class:"mb-5"},null,-1);function Go(e,t,o,i,s,n){const a=ne,l=K("AddLiquidity");return p(),m("div",null,[r("p",$o,[b(" Stake "+c(e.$config.lpTokenSymbol)+" to receive periodic staking rewards in "+c(e.$config.tokenSymbol)+" tokens (min deposit: "+c(n.minDeposit)+" "+c(e.$config.lpTokenSymbol)+"). ",1),S(a,{to:"/post/?id=kjzl6cwe1jw147gcaq8o17j668j1vol8v4z0vmv0ris1g5qyqvmrxbn0bpif8wh"},{default:kt(()=>[b(" Learn more here. ")]),_:1})]),r("div",Mo,[r("button",Eo,c(e.$config.lpTokenSymbol),1),F(r("input",{"onUpdate:modelValue":t[0]||(t[0]=w=>s.depositAmount=w),type:"text",class:"form-control",placeholder:"0.00",disabled:s.waitingApproval||s.waitingDeposit},null,8,Po),[[V,s.depositAmount]]),r("button",{onClick:t[1]||(t[1]=(...w)=>n.setMaxInputTokenAmount&&n.setMaxInputTokenAmount(...w)),class:"btn btn-outline-secondary",type:"button",id:"button-addon2"},No)]),r("small",Uo,[r("em",null,[b(" Balance: "),r("span",{class:"cursor-pointer hover-color",onClick:t[2]||(t[2]=(...w)=>n.setMaxInputTokenAmount&&n.setMaxInputTokenAmount(...w))},c(n.lpTokenBalance)+" "+c(e.$config.lpTokenSymbol),1)])]),r("div",Ro,[n.allowanceTooLow?(p(),m("button",{key:0,disabled:s.waitingApproval||n.depositTooLow,class:"btn btn-outline-primary",type:"button",onClick:t[3]||(t[3]=(...w)=>n.approveToken&&n.approveToken(...w))},[o.loadingStakingData||s.waitingApproval?(p(),m("span",jo)):k("",!0),b(" Approve token ")],8,Ho)):k("",!0),n.allowanceTooLow?k("",!0):(p(),m("button",{key:1,disabled:s.waitingDeposit||n.depositTooLow,class:"btn btn-outline-primary",type:"button",onClick:t[4]||(t[4]=(...w)=>n.deposit&&n.deposit(...w))},[o.loadingStakingData||s.waitingDeposit?(p(),m("span",qo)):k("",!0),b(" Stake ")],8,Oo))]),r("p",Fo,[n.allowanceTooLow?(p(),m("small",Vo,Xo)):k("",!0)]),zo,S(l)])}const Ko=H(Do,[["render",Go]]),Jo={name:"RemoveLiquidity",data(){return{allowanceWei:0,debounce:null,depositAmount:0,nativeCoinAmount:0,nativeCoinAmountWei:null,timeout:800,waitingApproval:!1,waitingDeposit:!1}},components:{WaitingToast:L},mounted(){this.address&&this.fetchAllowance()},computed:{allowanceTooLow(){return Number(this.allowanceWei)<Number(this.depositAmountWei)},lpBalanceTooLow(){return Number(this.userStore.getLpTokenBalanceWei)<Number(this.depositAmountWei)},lpTokenBalance(){return D(this.userStore.getLpTokenBalanceWei)},depositAmountWei(){return!this.depositAmount||Number(this.depositAmount)===0?0:U(String(this.depositAmount))}},methods:{async approveToken(){this.waitingApproval=!0;const e=new A(["function approve(address spender, uint256 amount) public returns (bool)"]),t=new C(this.$config.lpTokenAddress,e,this.signer);try{const o=await t.approve(this.$config.swapRouterAddress,this.depositAmountWei),i=this.toast({component:L,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),s=await o.wait();s.status===1?(this.allowanceWei=this.depositAmountWei,this.toast.dismiss(i),this.toast("You have successfully approved tokens. Now proceed with removing liquidity!",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),this.waitingApproval=!1,this.deposit()):(this.toast.dismiss(i),this.waitingApproval=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),console.log(s))}catch(o){console.error(o),this.waitingApproval=!1}},async deposit(){this.waitingDeposit=!0;const e=new A(["function removeLiquidityETH(address token,uint liquidity,uint amountTokenMin,uint amountETHMin,address to,uint deadline) external returns (uint amountToken, uint amountETH)","function calculateETHAndTokensToReceive(address _lpToken, uint256 _lpAmount) external view returns (uint256 amountToken, uint256 amountETH)"]),t=new C(this.$config.swapRouterAddress,e,this.signer),o=await t.calculateETHAndTokensToReceive(this.$config.chatTokenAddress,U(String(this.depositAmount))),i=Math.floor(Date.now()/1e3)+60*this.siteStore.getSwapDeadline,s=Math.floor(Number(this.siteStore.getSlippage)*100),n=o[1].sub(o[1].div(1e4).mul(s)),a=o[0].sub(o[0].div(1e4).mul(s));console.log("ncAmountWeiMin",Number(n)),console.log("tokenAmountWeiMin",Number(a));try{const l=await t.removeLiquidityETH(this.$config.chatTokenAddress,this.depositAmountWei,a,n,this.address,i),w=this.toast({component:L,props:{text:`Removing liquidity from the ${this.$config.lpTokenSymbol}-${this.$config.tokenSymbol} pool...`}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+l.hash,"_blank").focus()}),T=await l.wait();T.status===1?(this.toast.dismiss(w),this.toast(`You have successfully removed liquidity and received ${this.$config.lpTokenSymbol} & ${this.$config.tokenSymbol}!`,{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+l.hash,"_blank").focus()}),this.allowanceWei.sub(this.depositAmountWei),this.userStore.setLpTokenBalanceWei(this.userStore.getLpTokenBalanceWei.sub(this.depositAmountWei))):(this.toast.dismiss(w),this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+l.hash,"_blank").focus()}),console.log(T))}catch(l){console.error(l)}finally{this.waitingDeposit=!1}},async fetchAllowance(){const e=new A(["function allowance(address owner, address spender) public view returns (uint256)"]),t=new C(this.$config.lpTokenAddress,e,this.signer);this.allowanceWei=await t.allowance(this.address,this.$config.swapRouterAddress)},setMaxInputTokenAmount(){this.depositAmount=this.lpTokenBalance}},setup(){const{address:e,balance:t,signer:o}=j(),i=X(),s=z(),n=St();return{address:e,balance:t,signer:o,siteStore:n,toast:i,userStore:s}},watch:{address(e,t){e&&this.fetchAllowance()}}},Qo={class:"text-center"},Zo={class:"input-group mt-5"},tn={class:"btn btn-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:""},en=["disabled"],on=r("small",null,"MAX",-1),nn=[on],sn={class:"text-muted"},an={class:"d-flex justify-content-center mt-4 mb-4"},rn=["disabled"],ln={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},cn=["disabled"],un={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},dn={class:"text-center"},hn={key:0,class:"text-center"};function pn(e,t,o,i,s,n){return p(),m(wt,null,[r("p",Qo," Remove liquidity and get back "+c(e.$config.chatTokenSymbol)+" & "+c(e.$config.tokenSymbol)+" tokens. ",1),r("div",Zo,[r("button",tn,c(e.$config.lpTokenSymbol),1),F(r("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.depositAmount=a),type:"text",class:"form-control",placeholder:"0.00",disabled:s.waitingApproval||s.waitingDeposit},null,8,en),[[V,s.depositAmount]]),r("button",{onClick:t[1]||(t[1]=(...a)=>n.setMaxInputTokenAmount&&n.setMaxInputTokenAmount(...a)),class:"btn btn-outline-secondary",type:"button",id:"button-addon2"},nn)]),r("small",sn,[r("em",null,[b(" Balance: "),r("span",{class:"cursor-pointer hover-color",onClick:t[2]||(t[2]=(...a)=>n.setMaxInputTokenAmount&&n.setMaxInputTokenAmount(...a))},c(n.lpTokenBalance)+" "+c(e.$config.lpTokenSymbol),1)])]),r("div",an,[n.allowanceTooLow?(p(),m("button",{key:0,disabled:s.waitingApproval,class:"btn btn-outline-primary",type:"button",onClick:t[3]||(t[3]=(...a)=>n.approveToken&&n.approveToken(...a))},[s.waitingApproval?(p(),m("span",ln)):k("",!0),b(" Approve "+c(e.$config.lpTokenSymbol),1)],8,rn)):k("",!0),n.allowanceTooLow?k("",!0):(p(),m("button",{key:1,disabled:s.waitingDeposit,class:"btn btn-outline-primary",type:"button",onClick:t[4]||(t[4]=(...a)=>n.deposit&&n.deposit(...a))},[s.waitingDeposit?(p(),m("span",un)):k("",!0),b(" Remove liquidity ")],8,cn))]),r("p",dn,[n.allowanceTooLow?(p(),m("small",hn,[r("em",null," You will need to do 2 transactions: Approve "+c(e.$config.lpTokenSymbol)+" and then Remove liquidity. ",1)])):k("",!0)])],64)}const mn=H(Jo,[["render",pn]]),fn={name:"StakingWithdrawal",props:["loadingStakingData","lockedTimeLeft","minDepositWei","lpTokenDecimals"],emits:["clearClaimAmount"],data(){return{withdrawalAmount:0,waitingWithdrawal:!1}},components:{RemoveLiquidity:mn},computed:{isWithdrawalAmountNullOrEmpty(){return this.withdrawalAmount===null||this.withdrawalAmount===""||this.withdrawalAmount==0||Number(this.withdrawalAmount)===0},lockedSecondsHumanReadable(){const e=Number(this.lockedTimeLeft),t=Math.floor(e/60),o=Math.floor(t/60),i=Math.floor(o/24);return i>0?`${i+1} days`:o>0?`${o+1} hours`:t>0?`${t+1} minutes`:`${e+1} seconds`},minDeposit(){return Wt(String(this.minDepositWei),Number(this.lpTokenDecimals))},stakeTokenBalance(){return D(this.userStore.getStakeTokenBalanceWei)},withdrawalAmountWei(){return!this.withdrawalAmount||Number(this.withdrawalAmount)===0?0:U(String(this.withdrawalAmount))},withdrawalIncorrect(){if(Number(this.lockedTimeLeft)>0)return{error:!0,message:"Your staked tokens are still locked for "+this.lockedSecondsHumanReadable+"."};if(Number(this.withdrawalAmountWei)>Number(this.userStore.getStakeTokenBalanceWei))return{error:!0,message:"The amount exceeds your staked token balance."};if(Number(this.withdrawalAmountWei)<Number(this.userStore.getStakeTokenBalanceWei)){const e=Number(this.userStore.getStakeTokenBalanceWei)-Number(this.withdrawalAmountWei);if(Number(e)<Number(this.minDepositWei))return{error:!0,message:"You cannot unstake this amount because the staked balance left will be less than the minimum required staking amount ("+String(Number(this.minDeposit))+" tokens)."}}return{error:!1,message:""}}},methods:{async withdrawal(){this.waitingWithdrawal=!0;const e=new A(["function withdraw(uint256 _assets) external returns (uint256)"]),t=new C(this.$config.stakingContractAddress,e,this.signer);try{const o=await t.withdraw(this.withdrawalAmountWei),i=this.toast({component:L,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),s=await o.wait();s.status===1?(this.userStore.setLpTokenBalanceWei(this.userStore.getLpTokenBalanceWei.add(this.withdrawalAmountWei)),this.userStore.setStakeTokenBalanceWei(this.userStore.getStakeTokenBalanceWei.sub(this.withdrawalAmountWei)),this.$emit("clearClaimAmount"),this.toast.dismiss(i),this.toast("You have successfully unstaked tokens!",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),this.waitingWithdrawal=!1):(this.toast.dismiss(i),this.waitingWithdrawal=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+o.hash,"_blank").focus()}),console.log(s))}catch(o){console.error(o);try{let i=o.message.split("reason=")[1];i=i.split(", method=")[0],i=i.replace(/"/g,""),i=i.replace("execution reverted:","Error:"),i=i.replace("PeriodicEthRewards: ",""),console.log(i),this.toast(i,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waitingWithdrawal=!1}},setMaxInputTokenAmount(){this.withdrawalAmount=this.stakeTokenBalance}},setup(){const{address:e,signer:t}=j(),o=X(),i=z();return{address:e,signer:t,toast:o,userStore:i}}},kn={class:"text-center"},wn={class:"input-group mt-5"},gn={class:"btn btn-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:""},bn=["disabled"],yn=r("small",null,"MAX",-1),Tn=[yn],_n={class:"text-muted"},vn={class:"d-flex justify-content-center mt-4 mb-4"},An=["disabled"],Cn={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},xn={key:0,class:"alert alert-warning text-center text-dark",role:"alert"},Wn=r("hr",null,null,-1);function Sn(e,t,o,i,s,n){const a=K("RemoveLiquidity");return p(),m("div",null,[r("p",kn," Unstake "+c(e.$config.stakeTokenSymbol)+" to receive back "+c(e.$config.lpTokenSymbol)+" (it will also auto-claim any remaining rewards). ",1),r("div",wn,[r("button",gn,c(e.$config.stakeTokenSymbol),1),F(r("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.withdrawalAmount=l),type:"text",class:"form-control",placeholder:"0.00",disabled:s.waitingWithdrawal},null,8,bn),[[V,s.withdrawalAmount]]),r("button",{onClick:t[1]||(t[1]=(...l)=>n.setMaxInputTokenAmount&&n.setMaxInputTokenAmount(...l)),class:"btn btn-outline-secondary",type:"button",id:"button-addon2"},Tn)]),r("small",_n,[r("em",null,[b(" Balance: "),r("span",{class:"cursor-pointer hover-color",onClick:t[2]||(t[2]=(...l)=>n.setMaxInputTokenAmount&&n.setMaxInputTokenAmount(...l))},c(n.stakeTokenBalance)+" "+c(e.$config.stakeTokenSymbol),1)])]),r("div",vn,[r("button",{disabled:s.waitingWithdrawal||n.withdrawalIncorrect.error||n.isWithdrawalAmountNullOrEmpty,class:"btn btn-outline-primary",type:"button",onClick:t[3]||(t[3]=(...l)=>n.withdrawal&&n.withdrawal(...l))},[o.loadingStakingData||s.waitingWithdrawal?(p(),m("span",Cn)):k("",!0),b(" Unstake ")],8,An)]),n.withdrawalIncorrect.error?(p(),m("div",xn,c(n.withdrawalIncorrect.message),1)):k("",!0),Wn,S(a)])}const Bn=H(fn,[["render",Sn]]),Ln={name:"Stake",data(){return{claimAmountWei:0,claimRewardsTotalWei:0,currentTab:"deposit",futureRewardsWei:0,lastClaimPeriod:0,loadingStakingData:!1,lockedTimeLeft:0,minDepositWei:0,maxDepositWei:0,periodLength:0,stakingContract:null,lpToken:null,lpTokenAllowanceWei:0,lpTokenDecimals:18}},components:{StakingClaim:io,StakingDeposit:Ko,StakingWithdrawal:Bn},mounted(){this.currentTab=localStorage.getItem("stakeCurrentTab"),this.currentTab||(this.currentTab="deposit"),this.address&&this.fetchStakingData()},methods:{changeCurrentTab(e){this.currentTab=e,localStorage.setItem("stakeCurrentTab",e)},clearClaimAmount(){this.claimAmountWei=0},async fetchClaimRewardsTotal(){this.claimRewardsTotalWei=await this.stakingContract.claimRewardsTotal()},async fetchFutureRewards(){this.futureRewardsWei=await this.stakingContract.futureRewards()},async fetchLockedTimeLeft(){this.lockedTimeLeft=await this.stakingContract.getLockedTimeLeft(this.address)},async fetchPreviewClaim(){this.claimAmountWei=await this.stakingContract.previewClaim(this.address)},async fetchStakingData(){this.loadingStakingData=!0;const e=new A(["function balanceOf(address _owner) public view returns (uint256)","function claimRewardsTotal() external view returns (uint256)","function futureRewards() external view returns (uint256)","function getLockedTimeLeft(address _user) external view returns (uint256)","function lastClaimPeriod() external view returns (uint256)","function minDeposit() external view returns (uint256)","function maxDeposit() external view returns (uint256)","function periodLength() external view returns (uint256)","function previewClaim(address _claimer) public view returns (uint256)"]);this.stakingContract=new C(this.$config.stakingContractAddress,e,this.signer);const t=new A(["function allowance(address _owner, address _spender) public view returns (uint256)","function balanceOf(address _owner) public view returns (uint256)","function decimals() public view returns (uint8)"]);this.lpToken=new C(this.$config.lpTokenAddress,t,this.signer),this.fetchPreviewClaim(),this.userStore.setLpTokenBalanceWei(await this.lpToken.balanceOf(this.address)),this.lpTokenAllowanceWei=await this.lpToken.allowance(this.address,this.$config.stakingContractAddress),this.userStore.setStakeTokenBalanceWei(await this.stakingContract.balanceOf(this.address)),this.fetchLockedTimeLeft(),this.minDepositWei=await this.stakingContract.minDeposit(),this.loadingStakingData=!1,this.lastClaimPeriod=await this.stakingContract.lastClaimPeriod(),this.periodLength=await this.stakingContract.periodLength(),this.maxDepositWei=await this.stakingContract.maxDeposit(),this.fetchClaimRewardsTotal(),this.fetchFutureRewards()},subtractBalance(e){this.userStore.setLpTokenBalanceWei(this.userStore.getLpTokenBalanceWei.sub(e)),this.userStore.setStakeTokenBalanceWei(this.userStore.getStakeTokenBalanceWei.add(e)),this.fetchLockedTimeLeft()},updateAllowance(e){this.lpTokenAllowanceWei=Number(e)},updateLastClaimPeriod(){this.lastClaimPeriod=Math.floor(Date.now()/1e3),this.fetchPreviewClaim(),this.fetchClaimRewardsTotal(),this.fetchFutureRewards()}},setup(){const{address:e,signer:t}=j(),o=z();return{address:e,signer:t,userStore:o}},watch:{address(){this.fetchStakingData()}}},Dn={class:"card border scroll-500"},$n={class:"card-body"},Mn={class:"fs-3"},En={class:"nav nav-tabs nav-fill"},Pn={class:"nav-item"},In={class:"nav-item"},Nn={class:"nav-item"},Un={class:"tab-content mt-3"},Rn={key:0},Hn={class:"d-flex justify-content-center mt-5"},jn={class:"col-12 col-lg-8"},On={key:1},qn={class:"d-flex justify-content-center mt-5"},Fn={class:"col-12 col-lg-8"},Vn={key:2},Yn={class:"d-flex justify-content-center mt-5"},Xn={class:"col-12 col-lg-8"};function zn(e,t,o,i,s,n){const a=Zt,l=te,w=Qt,T=K("StakingDeposit"),v=K("StakingClaim"),I=K("StakingWithdrawal");return p(),m(wt,null,[S(w,null,{default:kt(()=>[S(a,null,{default:kt(()=>[b("Stake and Earn | "+c(e.$config.projectMetadataTitle),1)]),_:1}),S(l,{property:"og:title",content:"Stake and Earn"}),S(l,{name:"description",content:"Stake and earn "+e.$config.tokenSymbol+" on "+e.$config.projectName+"!"},null,8,["content"]),S(l,{property:"og:image",content:e.$config.projectUrl+e.$config.previewImageStake},null,8,["content"]),S(l,{property:"og:description",content:"Stake and earn "+e.$config.tokenSymbol+" on "+e.$config.projectName+"!"},null,8,["content"]),S(l,{name:"twitter:image",content:e.$config.projectUrl+e.$config.previewImageStake},null,8,["content"]),S(l,{name:"twitter:description",content:"Stake and earn "+e.$config.tokenSymbol+" on "+e.$config.projectName+"!"},null,8,["content"])]),_:1}),r("div",Dn,[r("div",$n,[r("p",Mn,[r("i",{class:"bi bi-arrow-left-circle cursor-pointer",onClick:t[0]||(t[0]=f=>e.$router.back())})]),r("ul",En,[r("li",Pn,[r("button",{class:nt(["nav-link",s.currentTab==="deposit"?"active":""]),onClick:t[1]||(t[1]=f=>n.changeCurrentTab("deposit"))},"Stake",2)]),r("li",In,[r("button",{class:nt(["nav-link",s.currentTab==="claim"?"active":""]),onClick:t[2]||(t[2]=f=>n.changeCurrentTab("claim"))},"Claim",2)]),r("li",Nn,[r("button",{class:nt(["nav-link",s.currentTab==="withdraw"?"active":""]),onClick:t[3]||(t[3]=f=>n.changeCurrentTab("withdraw"))},"Unstake",2)])]),r("div",Un,[s.currentTab==="deposit"?(p(),m("div",Rn,[r("div",Hn,[r("div",jn,[S(T,{loadingStakingData:s.loadingStakingData,minDepositWei:s.minDepositWei,maxDepositWei:s.maxDepositWei,lpTokenAllowanceWei:s.lpTokenAllowanceWei,lpTokenDecimals:s.lpTokenDecimals,onClearClaimAmount:n.clearClaimAmount,onSubtractBalance:n.subtractBalance,onUpdateAllowance:n.updateAllowance},null,8,["loadingStakingData","minDepositWei","maxDepositWei","lpTokenAllowanceWei","lpTokenDecimals","onClearClaimAmount","onSubtractBalance","onUpdateAllowance"])])])])):k("",!0),s.currentTab==="claim"?(p(),m("div",On,[r("div",qn,[r("div",Fn,[S(v,{loadingStakingData:s.loadingStakingData,claimAmountWei:s.claimAmountWei,claimRewardsTotalWei:s.claimRewardsTotalWei,futureRewardsWei:s.futureRewardsWei,lastClaimPeriod:s.lastClaimPeriod,minDepositWei:s.minDepositWei,periodLength:s.periodLength,onClearClaimAmount:n.clearClaimAmount,onUpdateLastClaimPeriod:n.updateLastClaimPeriod},null,8,["loadingStakingData","claimAmountWei","claimRewardsTotalWei","futureRewardsWei","lastClaimPeriod","minDepositWei","periodLength","onClearClaimAmount","onUpdateLastClaimPeriod"])])])])):k("",!0),s.currentTab==="withdraw"?(p(),m("div",Vn,[r("div",Yn,[r("div",Xn,[S(I,{loadingStakingData:s.loadingStakingData,lockedTimeLeft:s.lockedTimeLeft,minDepositWei:s.minDepositWei,lpTokenDecimals:s.lpTokenDecimals,onClearClaimAmount:n.clearClaimAmount},null,8,["loadingStakingData","lockedTimeLeft","minDepositWei","lpTokenDecimals","onClearClaimAmount"])])])])):k("",!0)])])])],64)}const os=H(Ln,[["render",zn]]);export{os as default};
